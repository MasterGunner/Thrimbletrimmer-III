!function(t){t.fn.wEditor=function(e){var i={submitLoc:null,startOffset:0,endOffset:0,vidID:"",title:"",description:"",extraMetadata:function(){return[]}},e=t.extend(i,e),n=0,a=0;return this.each(function(){var i=this,r=t(i).parent(),d=t('<div class="wub-video-editorControls" ><div class="wub-editor-selectRange"></div><input type="checkbox" id="EndPlaybackCheckbox" /><span style="font-size: 0.7em; color:#999">Stop Here</span><div style="clear:both;"><div id="StartControl"><input type="text" id="StartTimeStamp" value="00:00.00" /><br /><input type="button" id="SetStartTimeButton" value="Set" /><input type="button" id="GoToStartButton" value="Go To" /></div><div id="EndControl"><input type="text" id="EndTimeStamp" value="00:00.00" /><br /><input type="button" id="SetEndTimeButton" value="Set" /><input type="button" id="GoToEndButton" value="Go To" /></div></div></div>'),o=t('<div id="EditorDetailsPane" style="clear:both; padding-top:5px;"><div>Title:<br /><input type="text" id="VideoTitle" value="'+t("<div>").text(e.title).html().replace(/"/g,"&quot;").replace(/'/g,"&#39")+'" maxlength="91" /></div><div>Description:<br/><textarea id="VideoDescription" >'+t("<div>").text(e.description).html().replace(/"/g,"&quot;").replace(/'/g,"&#39")+'</textarea></div><input type="button" id="SubmitButton" value="Submit" /></div>');r.append(d),r.after(o);var d=t(".wub-video-editorControls",r),u=t(".wub-editor-selectRange",d),l=t("#EndPlaybackCheckbox",d),s=t("#StartTimeStamp",d),c=t("#SetStartTimeButton",d),v=t("#GoToStartButton",d),p=t("#EndTimeStamp",d),f=t("#SetEndTimeButton",d),m=t("#GoToEndButton",d),T=t("#EditorDetailsPane",r.parent()),b=t("#VideoTitle",T),S=t("#VideoDescription",T),x=t("#SubmitButton",T),y=function(){i.readyState?(0==e.endOffset?i.duration:e.endOffset,n=e.startOffset,a=e.endOffset,s.val(h(n)),p.val(h(a)),u.slider({range:!0,min:0,max:i.duration,step:.01,values:[e.startOffset,e.endOffset],slide:function(t,e){n=e.values[0],a=e.values[1],s.val(h(n)),p.val(h(a))}}),c.click(function(){n=i.currentTime,s.val(h(i.currentTime)),u.slider("values",[i.currentTime,u.slider("values")[1]])}),s.change(function(){/^\d*:?\d*:?\d*\.?\d*$/.test(s.val())?(n=g(s.val()),s.val(h(n)),u.slider("values",[n,u.slider("values")[1]])):s.val(h(n))}),v.click(function(){i.currentTime=n}),f.click(function(){a=i.currentTime,p.val(h(i.currentTime)),u.slider("values",[u.slider("values")[0],i.currentTime])}),p.change(function(){/^\d*:?\d*:?\d*\.?\d*$/.test(p.val())?(a=g(p.val()),p.val(h(a)),u.slider("values",[u.slider("values")[0],a])):p.val(h(a))}),m.click(function(){i.currentTime=a}),t(i).on("timeupdate",function(){l.prop("checked")&&i.currentTime>=a&&(i.pause(),i.currentTime=a)}),x.click(function(){if(n>=a)alert("End Time must be greater than Start Time");else{var i={vidID:e.vidID,startOffset:n,endOffset:a,title:b.val(),description:S.val(),extraMetadata:e.extraMetadata()},r=t.post(e.submitLoc,i);r.done(function(t){alert("Successfully submitted video.\r\n"+t)}),r.fail(function(t){alert("Failed to submit video.\r\n"+t.status+" - "+t.responseText)})}})):setTimeout(y,150)};y();var h=function(t){var e=new Date(null);e.setSeconds(t);var i=parseInt(t%1*100);return e.toISOString().substr(11,8)+"."+i},g=function(t){for(var e=t.split(":"),i=0,n=1;e.length>0;)i+=n*e.pop(),n*=60;return i}})}}(jQuery);